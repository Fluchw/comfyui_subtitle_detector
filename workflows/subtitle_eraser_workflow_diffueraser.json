{
  "id": "faa1fdea-cb12-4e26-b75a-234366985252",
  "revision": 0,
  "last_node_id": 12,
  "last_link_id": 12,
  "nodes": [
    {
      "id": 1,
      "type": "SubtitleDetectorRapidOCR",
      "pos": [
        509.5875000000001,
        613.0875000000003
      ],
      "size": [
        315,
        400
      ],
      "flags": {},
      "order": 6,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 1
        }
      ],
      "outputs": [
        {
          "name": "annotated_images",
          "type": "IMAGE",
          "slot_index": 0,
          "links": [
            6
          ]
        },
        {
          "name": "subtitle_mask",
          "type": "MASK",
          "slot_index": 1,
          "links": [
            9,
            11
          ]
        }
      ],
      "title": "2. Detect Subtitles",
      "properties": {
        "Node name for S&R": "SubtitleDetectorRapidOCR"
      },
      "widgets_values": [
        "detect_only",
        "MOBILE",
        0.3,
        0.8,
        "sharpen",
        "red_hollow",
        0,
        true,
        "union",
        6
      ]
    },
    {
      "id": 2,
      "type": "VHS_VideoCombine",
      "pos": [
        1850.75,
        561.75
      ],
      "size": [
        315,
        334
      ],
      "flags": {},
      "order": 11,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 2
        },
        {
          "name": "audio",
          "shape": 7,
          "type": "AUDIO",
          "link": 3
        },
        {
          "name": "meta_batch",
          "shape": 7,
          "type": "VHS_BatchManager",
          "link": null
        },
        {
          "name": "vae",
          "shape": 7,
          "type": "VAE",
          "link": null
        },
        {
          "name": "frame_rate",
          "type": "FLOAT",
          "widget": {
            "name": "frame_rate"
          },
          "link": 4
        }
      ],
      "outputs": [
        {
          "name": "Filenames",
          "type": "VHS_FILENAMES",
          "links": null
        }
      ],
      "title": "5. Save Video",
      "properties": {
        "cnr_id": "comfyui-videohelpersuite",
        "ver": "1.7.9",
        "Node name for S&R": "VHS_VideoCombine"
      },
      "widgets_values": {
        "frame_rate": 24,
        "loop_count": 0,
        "filename_prefix": "subtitle_erased",
        "format": "video/h264-mp4",
        "pix_fmt": "yuv420p",
        "crf": 19,
        "save_metadata": true,
        "trim_to_audio": false,
        "pingpong": false,
        "save_output": true,
        "videopreview": {
          "hidden": false,
          "paused": false,
          "params": {
            "filename": "subtitle_erased_00002-audio.mp4",
            "subfolder": "",
            "type": "output",
            "format": "video/h264-mp4",
            "frame_rate": 30,
            "workflow": "subtitle_erased_00002.png",
            "fullpath": "/workspace/ComfyUI/output/subtitle_erased_00002-audio.mp4"
          }
        }
      }
    },
    {
      "id": 4,
      "type": "VHS_LoadVideo",
      "pos": [
        32,
        500.5
      ],
      "size": [
        250,
        453.5
      ],
      "flags": {},
      "order": 0,
      "mode": 0,
      "inputs": [
        {
          "name": "meta_batch",
          "shape": 7,
          "type": "VHS_BatchManager",
          "link": null
        },
        {
          "name": "vae",
          "shape": 7,
          "type": "VAE",
          "link": null
        }
      ],
      "outputs": [
        {
          "name": "IMAGE",
          "type": "IMAGE",
          "slot_index": 0,
          "links": [
            1,
            8,
            10
          ]
        },
        {
          "name": "frame_count",
          "type": "INT",
          "slot_index": 1,
          "links": null
        },
        {
          "name": "audio",
          "type": "AUDIO",
          "slot_index": 2,
          "links": [
            3
          ]
        },
        {
          "name": "video_info",
          "type": "VHS_VIDEOINFO",
          "slot_index": 3,
          "links": [
            5
          ]
        }
      ],
      "title": "1. Load Video",
      "properties": {
        "cnr_id": "comfyui-videohelpersuite",
        "ver": "1.7.9",
        "Node name for S&R": "VHS_LoadVideo"
      },
      "widgets_values": {
        "video": "t1.mp4",
        "force_rate": 0,
        "custom_width": 0,
        "custom_height": 0,
        "frame_load_cap": 0,
        "skip_first_frames": 0,
        "select_every_nth": 1,
        "format": "AnimateDiff",
        "videopreview": {
          "hidden": false,
          "paused": false,
          "params": {
            "filename": "t1.mp4",
            "type": "input",
            "format": "video/mp4"
          }
        }
      }
    },
    {
      "id": 5,
      "type": "VHS_VideoInfo",
      "pos": [
        334.5,
        1068
      ],
      "size": [
        235,
        206
      ],
      "flags": {},
      "order": 7,
      "mode": 0,
      "inputs": [
        {
          "name": "video_info",
          "type": "VHS_VIDEOINFO",
          "link": 5
        }
      ],
      "outputs": [
        {
          "name": "source_fpsğŸŸ¨",
          "type": "FLOAT",
          "slot_index": 0,
          "links": [
            4,
            7
          ]
        },
        {
          "name": "source_frame_countğŸŸ¨",
          "type": "INT",
          "slot_index": 1,
          "links": null
        },
        {
          "name": "source_durationğŸŸ¨",
          "type": "FLOAT",
          "slot_index": 2,
          "links": null
        },
        {
          "name": "source_widthğŸŸ¨",
          "type": "INT",
          "slot_index": 3,
          "links": null
        },
        {
          "name": "source_heightğŸŸ¨",
          "type": "INT",
          "slot_index": 4,
          "links": null
        },
        {
          "name": "loaded_fpsğŸŸ¦",
          "type": "FLOAT",
          "links": null
        },
        {
          "name": "loaded_frame_countğŸŸ¦",
          "type": "INT",
          "links": null
        },
        {
          "name": "loaded_durationğŸŸ¦",
          "type": "FLOAT",
          "links": null
        },
        {
          "name": "loaded_widthğŸŸ¦",
          "type": "INT",
          "links": null
        },
        {
          "name": "loaded_heightğŸŸ¦",
          "type": "INT",
          "links": null
        }
      ],
      "title": "Video Info",
      "properties": {
        "cnr_id": "comfyui-videohelpersuite",
        "ver": "1.7.9",
        "Node name for S&R": "VHS_VideoInfo"
      },
      "widgets_values": {}
    },
    {
      "id": 6,
      "type": "Note",
      "pos": [
        589.5,
        1039.25
      ],
      "size": [
        320,
        280
      ],
      "flags": {},
      "order": 1,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "ProPainter Parameters",
      "properties": {},
      "widgets_values": [
        "== SubtitleEraserProPainter å‚æ•°è¯´æ˜ ==\n\nâ€¢ mask_dilation (0-20, é»˜è®¤4)\n  maskè†¨èƒ€åƒç´ ï¼Œæ‰©å¤§æ“¦é™¤åŒºåŸŸè¾¹ç¼˜\n\nâ€¢ ref_stride (1-50, é»˜è®¤10)\n  å‚è€ƒå¸§æ­¥é•¿ï¼Œè¶Šå°è´¨é‡è¶Šå¥½ä½†è¶Šæ…¢\n\nâ€¢ neighbor_length (2-50, é»˜è®¤10)\n  é‚»è¿‘å¸§æ•°é‡ï¼Œç”¨äºæ—¶åºä¸€è‡´æ€§\n\nâ€¢ subvideo_length (10-200, é»˜è®¤80)\n  å­è§†é¢‘é•¿åº¦ï¼Œé•¿è§†é¢‘ä¼šåˆ†æ®µå¤„ç†\n\nâ€¢ raft_iter (1-40, é»˜è®¤20)\n  RAFTå…‰æµè¿­ä»£æ¬¡æ•°\n\nâ€¢ fp16 (é»˜è®¤True)\n  åŠç²¾åº¦æ¨ç†ï¼ŒèŠ‚çœæ˜¾å­˜\n\nâ€¢ chunk_size (0-100, é»˜è®¤0=è‡ªåŠ¨)"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 7,
      "type": "VHS_VideoCombine",
      "pos": [
        1097,
        1003
      ],
      "size": [
        315,
        513.9375
      ],
      "flags": {},
      "order": 9,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 6
        },
        {
          "name": "audio",
          "shape": 7,
          "type": "AUDIO",
          "link": null
        },
        {
          "name": "meta_batch",
          "shape": 7,
          "type": "VHS_BatchManager",
          "link": null
        },
        {
          "name": "vae",
          "shape": 7,
          "type": "VAE",
          "link": null
        },
        {
          "name": "frame_rate",
          "type": "FLOAT",
          "widget": {
            "name": "frame_rate"
          },
          "link": 7
        }
      ],
      "outputs": [
        {
          "name": "Filenames",
          "type": "VHS_FILENAMES",
          "links": null
        }
      ],
      "title": "Preview Detection",
      "properties": {
        "cnr_id": "comfyui-videohelpersuite",
        "ver": "1.7.9",
        "Node name for S&R": "VHS_VideoCombine"
      },
      "widgets_values": {
        "frame_rate": 24,
        "loop_count": 0,
        "filename_prefix": "detection_preview",
        "format": "video/h264-mp4",
        "pix_fmt": "yuv420p",
        "crf": 19,
        "save_metadata": false,
        "trim_to_audio": false,
        "pingpong": false,
        "save_output": false,
        "videopreview": {
          "hidden": false,
          "paused": false,
          "params": {
            "filename": "detection_preview_00001.mp4",
            "subfolder": "",
            "type": "temp",
            "format": "video/h264-mp4",
            "frame_rate": 30,
            "workflow": "detection_preview_00001.png",
            "fullpath": "/workspace/ComfyUI/temp/detection_preview_00001.mp4"
          }
        }
      }
    },
    {
      "id": 8,
      "type": "Note",
      "pos": [
        1096.6561881019056,
        216.54654736698302
      ],
      "size": [
        650,
        280
      ],
      "flags": {},
      "order": 2,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "Parameter Tuning Guide / å‚æ•°è°ƒä¼˜æŒ‡å—",
      "properties": {},
      "widgets_values": [
        "== å‚æ•°è°ƒä¼˜æŒ‡å— ==\n\nã€å­—å¹•æ£€æµ‹è°ƒä¼˜ã€‘\nâ€¢ confidence_threshold: æ£€æµ‹ä¸åˆ°å­—å¹•æ—¶é™ä½ (0.2)ï¼Œè¯¯æ£€å¤ªå¤šæ—¶æé«˜ (0.5)\nâ€¢ scale_factor: å°å­—å¹•æé«˜ (0.9-1.0)ï¼Œå¤§å­—å¹•å¯é™ä½ (0.6-0.7) åŠ é€Ÿ\nâ€¢ mask_merge_mode: union=åˆå¹¶æ‰€æœ‰å¸§maskï¼Œper_frame=é€å¸§ç‹¬ç«‹mask\n\nã€ProPainter è°ƒä¼˜ã€‘\nâ€¢ mask_dilation: æ“¦é™¤ä¸å¹²å‡€æ—¶å¢å¤§ (6-8)ï¼Œå½±å“å‘¨å›´å†…å®¹æ—¶å‡å° (2)\nâ€¢ ref_stride: è¿½æ±‚è´¨é‡ç”¨ 5-8ï¼Œè¿½æ±‚é€Ÿåº¦ç”¨ 15-20\nâ€¢ neighbor_length: å¿«é€Ÿè¿åŠ¨åœºæ™¯å¢å¤§ (15-20)ï¼Œé™æ€åœºæ™¯å¯å‡å° (5-8)\nâ€¢ chunk_size: æ˜¾å­˜ä¸è¶³æ—¶å‡å°ï¼Œæ˜¾å­˜å……è¶³æ—¶å¢å¤§åŠ é€Ÿ\n\nã€DiffuEraser è°ƒä¼˜ã€‘\nâ€¢ steps: é…åˆ LoRA ä½¿ç”¨ï¼Œ2step LoRA ç”¨ steps=2ï¼Œ4step LoRA ç”¨ steps=4\nâ€¢ mask_dilation: è¾¹ç¼˜æœ‰æ®‹ç•™æ—¶å¢å¤§\nâ€¢ blended: è¾¹ç¼˜è¿‡æ¸¡ä¸è‡ªç„¶æ—¶å…³é—­è¯•è¯•\nâ€¢ prompt: æè¿°æœŸæœ›çš„èƒŒæ™¯ï¼Œå¦‚ \"clean wall\" \"blue sky\" ç­‰"
      ],
      "color": "#234",
      "bgcolor": "#345"
    },
    {
      "id": 9,
      "type": "Note",
      "pos": [
        2132.7747933884293,
        1240.3037190082644
      ],
      "size": [
        315,
        200
      ],
      "flags": {},
      "order": 3,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "License Notice",
      "properties": {},
      "widgets_values": [
        "== å•†ç”¨è®¸å¯è¯´æ˜ ==\n\næœ¬æ’ä»¶ä½¿ç”¨çš„æ¨¡å‹æœ‰ä¸åŒè®¸å¯è¯ï¼š\n\nâ€¢ RapidOCR: Apache-2.0 (å¯å•†ç”¨)\nâ€¢ ProPainter: ä»…é™éå•†ä¸šç”¨é€”\nâ€¢ DiffuEraser: Apache-2.0\n\nå¦‚éœ€å•†ç”¨ï¼Œè¯·è”ç³» ProPainter ä½œè€…è·å–æˆæƒ\n\nProPainter é¡¹ç›®åœ°å€:\nhttps://github.com/sczhou/ProPainter"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 10,
      "type": "Note",
      "pos": [
        1464.2210743801654,
        1142.9483471074382
      ],
      "size": [
        500,
        300
      ],
      "flags": {},
      "order": 4,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "DiffuEraser Parameters",
      "properties": {},
      "widgets_values": [
        "== SubtitleEraserDiffuEraser å‚æ•°è¯´æ˜ ==\n\nâ€¢ vae: VAE æ¨¡å‹æ–‡ä»¶\n  æ¨è: sd-vae-ft-mse.safetensors\n\nâ€¢ clip: CLIP æ–‡æœ¬ç¼–ç å™¨\n  æ¨è: clip_l.safetensors\n\nâ€¢ lora: å¯é€‰ LoRA åŠ é€Ÿ\n  - none: ä¸ä½¿ç”¨ (steps=4)\n  - pcm_sd15_smallcfg_2step: 2æ­¥åŠ é€Ÿ (steps=2)\n  - pcm_sd15_smallcfg_4step: 4æ­¥åŠ é€Ÿ (steps=4)\n\nâ€¢ prompt: æè¿°æœŸæœ›èƒŒæ™¯çš„æç¤ºè¯\n\nâ€¢ steps: æ¨ç†æ­¥æ•° (é…åˆ LoRA è°ƒæ•´)\n\nâ€¢ seed: éšæœºç§å­ (0=éšæœº)\n\nâ€¢ mask_dilation: mask è†¨èƒ€åƒç´ \n\nâ€¢ blended: æ˜¯å¦æ··åˆåŸå›¾è¾¹ç¼˜"
      ],
      "color": "#432",
      "bgcolor": "#653"
    },
    {
      "id": 11,
      "type": "SubtitleEraserProPainter",
      "pos": [
        1110.75,
        561.75
      ],
      "size": [
        315,
        350
      ],
      "flags": {},
      "order": 8,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 8
        },
        {
          "name": "masks",
          "type": "MASK",
          "link": 9
        }
      ],
      "outputs": [
        {
          "name": "erased_images",
          "type": "IMAGE",
          "slot_index": 0,
          "links": [
            12
          ]
        }
      ],
      "title": "3. ProPainter (Priori)",
      "properties": {
        "Node name for S&R": "SubtitleEraserProPainter"
      },
      "widgets_values": [
        "ProPainter.pth",
        "raft-things.pth",
        "recurrent_flow_completion.pth",
        4,
        10,
        10,
        80,
        20,
        true,
        60
      ]
    },
    {
      "id": 12,
      "type": "SubtitleEraserDiffuEraser",
      "pos": [
        1480.75,
        561.75
      ],
      "size": [
        315,
        416
      ],
      "flags": {},
      "order": 10,
      "mode": 0,
      "inputs": [
        {
          "name": "images",
          "type": "IMAGE",
          "link": 10
        },
        {
          "name": "masks",
          "type": "MASK",
          "link": 11
        },
        {
          "name": "priori_images",
          "type": "IMAGE",
          "link": 12
        }
      ],
      "outputs": [
        {
          "name": "erased_images",
          "type": "IMAGE",
          "slot_index": 0,
          "links": [
            2
          ]
        }
      ],
      "title": "4. DiffuEraser (Refine)",
      "properties": {
        "Node name for S&R": "SubtitleEraserDiffuEraser"
      },
      "widgets_values": [
        "diffusion_pytorch_model.safetensors",
        "clip_l.safetensors",
        "sd15/pcm_sd15_smallcfg_2step_converted.safetensors",
        "clean background, high quality",
        2,
        1,
        4,
        true,
        true,
        60,
        8,
        1,
        1
      ]
    },
    {
      "id": 3,
      "type": "Note",
      "pos": [
        428.25,
        173
      ],
      "size": [
        600,
        220
      ],
      "flags": {},
      "order": 5,
      "mode": 0,
      "inputs": [],
      "outputs": [],
      "title": "DiffuEraser Workflow - No SD1.5 Required",
      "properties": {},
      "widgets_values": [
        "== DiffuEraser å­—å¹•æ“¦é™¤å·¥ä½œæµ ==\n\nå·²ç§»é™¤ SD1.5 å®Œæ•´æ¨¡å‹ä¾èµ–ï¼åªéœ€è¦ï¼š\n- VAE: sd-vae-ft-mse.safetensors (models/vae/)\n- CLIP: clip_l.safetensors (models/clip/)\n- LoRA: pcm_sd15_smallcfg_2step (å¯é€‰ï¼Œ2æ­¥åŠ é€Ÿæ¨ç†)\n- ProPainter æ¨¡å‹ (models/DiffuEraser/)\n- DiffuEraser æ¨¡å‹ (models/DiffuEraser/brushnet/, unet_main/)\n\nå·¥ä½œæµç¨‹ï¼š\n1. VHS_LoadVideo åŠ è½½è§†é¢‘\n2. SubtitleDetectorRapidOCR æ£€æµ‹å­—å¹•\n3. SubtitleEraserProPainter åŸºç¡€æ“¦é™¤ (ç”Ÿæˆ priori)\n4. SubtitleEraserDiffuEraser æ‰©æ•£æ¨¡å‹ç²¾ä¿®\n5. VHS_VideoCombine ä¿å­˜è§†é¢‘"
      ],
      "color": "#432",
      "bgcolor": "#653"
    }
  ],
  "links": [
    [
      1,
      4,
      0,
      1,
      0,
      "IMAGE"
    ],
    [
      2,
      12,
      0,
      2,
      0,
      "IMAGE"
    ],
    [
      3,
      4,
      2,
      2,
      1,
      "AUDIO"
    ],
    [
      4,
      5,
      0,
      2,
      4,
      "FLOAT"
    ],
    [
      5,
      4,
      3,
      5,
      0,
      "VHS_VIDEOINFO"
    ],
    [
      6,
      1,
      0,
      7,
      0,
      "IMAGE"
    ],
    [
      7,
      5,
      0,
      7,
      4,
      "FLOAT"
    ],
    [
      8,
      4,
      0,
      11,
      0,
      "IMAGE"
    ],
    [
      9,
      1,
      1,
      11,
      1,
      "MASK"
    ],
    [
      10,
      4,
      0,
      12,
      0,
      "IMAGE"
    ],
    [
      11,
      1,
      1,
      12,
      1,
      "MASK"
    ],
    [
      12,
      11,
      0,
      12,
      2,
      "IMAGE"
    ]
  ],
  "groups": [],
  "config": {},
  "extra": {
    "workflowRendererVersion": "LG",
    "ds": {
      "scale": 0.6830134553650705,
      "offset": [
        88.96990000000028,
        -10.857399999999789
      ]
    },
    "frontendVersion": "1.38.11",
    "VHS_latentpreview": false,
    "VHS_latentpreviewrate": 0,
    "VHS_MetadataImage": true,
    "VHS_KeepIntermediate": true
  },
  "version": 0.4
}